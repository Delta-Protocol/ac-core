#!/bin/bash

home=`mktemp -d`

#---govd---
iGovHome='g'
LD_LIBRARY_PATH=gov govd/us-govd -d -home $home/$iGovHome -genesis 127.0.0.1
if [ $? -eq 0 ]; then
    echo "govd-> PASS"
 
else
    echo "govd-> FAIL"
	exit 1;

fi

ls $home

#---------------------------------------------------------------------



#--------------------1-gov-[72]------1-wallet:[73]--------------------------

#---govd--> 72 <--
#LD_LIBRARY_PATH=gov govd/us-govd -d -home $home/$iGovHome -p 16672 2>&1 >/dev/null &
#sleep 1
#pid_g_72=`ps ax | grep govd | grep -v grep | awk '{print $1}'`
#echo "pid_72=$pid_g_72"


#---walletd--> 73 <--                                          wallet port  backend port
#LD_LIBRARY_PATH=wallet:gov walletd/us-walletd -home $home -d -wp 16673 -bp 16672 2>&1 >/dev/null &
#sleep 1
#pid_w_73=`ps ax | grep walletd | grep -v grep | awk '{print $1}'`
#echo "pid_73=$pid_w_73"





g_port=16672
w_port=16673


for value in {1..3}
do                                                                 #
   LD_LIBRARY_PATH=gov govd/us-govd -d -home $home/$iGovHome -p $g_port 2>&1 >/dev/null &
   sleep 3
   pid_g=`ps ax | grep govd | grep -v grep | awk '{print $1}'`
   echo "--------$value------------"
   echo "gov pid= $pid_g  | node port = $g_port "
 
	for value in {1..4}
	do                                                          
		echo "-->>$value<<--"                                               #         #
		LD_LIBRARY_PATH=wallet:gov walletd/us-walletd -home $home -d -wp $w_port -bp $g_port 2>&1 >/dev/null &
		sleep 3
		pid_w=`ps ax | grep walletd | grep -v grep | awk '{print $1}'`
		echo "wallet pid= $pid_w | wallet port --> $w_port "
		let w_port++ 
	done

let g_port--
done









